<ng-template #extra>
      <span class="flex justify-between mx-6">
        <button mat-button (click)="history.back()">Volver</button>
        <span class="flex items-center">
          <mat-icon class="text-green-600">eco</mat-icon> = Vegetariana
        </span>
      </span>
</ng-template>

<mat-card class="w-full max-w-2xl h-full mx-auto" appearance="outlined">
  <mat-card-content class="my-4">
    <form [formGroup]="form" (ngSubmit)="onSubmit()" class="flex flex-col gap-4">
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <mat-form-field>
          <mat-label>Nombre de la comida</mat-label>
          <input matInput type="text" formControlName="nombre" placeholder="Nombre"
                 (blur)="updateErrorMessage('nombre')"
                 required>
          <mat-hint align="end">{{ form.get('nombre')?.value?.length || 0 }}/255</mat-hint>
          @if (errorMessages['nombre']) {
            <mat-error>{{ errorMessages['nombre'] }}</mat-error>
          }
        </mat-form-field>
        <mat-form-field floatLabel="always">
          <mat-label>Precio de la comida</mat-label>
          <input matInput type="number" class="precio-input" formControlName="precio" placeholder="0"
                 (blur)="updateErrorMessage('precio')" required/>
          <span matTextPrefix>$&nbsp;</span>
          @if (errorMessages['precio']) {
            <mat-error>{{ errorMessages['precio'] }}</mat-error>
          }
        </mat-form-field>
      </div>
      <mat-checkbox formControlName="vegetariano">¿Es vegetariana?</mat-checkbox>
      @if (errorMessages['vegetariano']) {
        <mat-error>{{ errorMessages['vegetariano'] }}</mat-error>
      }
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <mat-form-field>
          <mat-label>Tipo de comida</mat-label>
          <input type="text"
                 [placeholder]="('Seleccione un tipo de comida')"
                 matInput
                 (blur)="updateErrorMessage(tiposDeComida.toString())"
          >
            @for (tipo of tiposDeComida; track tipo) {
              <mat-option [value]="tipo">
                                  <span class="flex items-center gap-4">
                                    <span class="flex items-center">
                                      <span>{{ tipo.toString() }}</span>
                                    </span>
                                  </span>
              </mat-option>
            }
          @if (errorMessages[tiposDeComida.toString()]) {
            <mat-error>{{ errorMessages[tiposDeComida.toString()] }}</mat-error>
          }
          @if (hints[tiposDeComida.toString()]) {
            <mat-hint>{{ hints[tiposDeComida.toString()] }}</mat-hint>
          }
        </mat-form-field>
      </div>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <mat-form-field>
          <mat-label>Url Imagen</mat-label>
          <input
            matInput
            type="text"
            formControlName="urlImagen"
            placeholder="Ingrese url de la imagen"
            (blur)="updateErrorMessage('urlImagen')"
          >
          @if (errorMessages['urlImagen']) {
            <mat-error>{{ errorMessages['urlImagen'] }}</mat-error>
          }
        </mat-form-field>
      </div>
      <div class="ms-4">
        @if (error) {
          <mat-error>Por favor, intente nuevamente más tarde</mat-error>
        } @else if (form.errors ? deberiaMostrarErrorTipoComida() && form.errors['ningunoSeleccionada'] : false) {
          <mat-error>Debe seleccionar un tipo de comida (entrada, plato principal, postre, bebida u otro)
          </mat-error>
        }
      </div>
      <button mat-raised-button class="w-full" type="submit"
              [disabled]="form.invalid || !form.dirty">{{ form.pending ? 'Enviando' : 'Enviar' }}
      </button>
    </form>
  </mat-card-content>
</mat-card>
